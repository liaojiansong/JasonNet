{{extend name="public:base" /}}
<!--标题-->
{{block name="title"}}
接入指南
{{/block}}

<!--主体-->
{{block name="main"}}
<!-- 内容墙,包含顶部面板 -->
<div class="content-wrapper">
	<section class="content-header">
		<h1>
			设备接入指南
		</h1>
		<ol class="breadcrumb">
			<li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
			<li><a href="#">API管理</a></li>
			<li class="active">设备接入指南</li>
		</ol>
	</section>

	<!-- Main content -->
    <section class="content">
        <!-- row -->
        <div class="row">
            <div class="col-md-12">
                <!-- The time line -->
                <ul class="timeline">
                    <!-- timeline time label -->
                    <li class="time-label">
                        <span class="bg-red">第一步</span>
                    </li>
                    <!-- /.timeline-label -->
                    <!-- timeline item -->
                    <li>
                        <i class="fa fa-envelope bg-blue"></i>

                        <div class="timeline-item">

                            <h3 class="timeline-header"><a href="#">用户注册</a> </h3>

                            <div class="timeline-body">
                                <h4>用户打开连接
                                    <a href="http://jasonnet.com/index/login/register.html">JasonNet物联网连接管理云平台</a>,填入基础信息后点击注册按钮.如下图所示</h4>
                                <img src="__STATIC__/customer/img/resiger.jpg" class="margin" height="400" width="700"/>
                            </div>
                           
                        </div>
                    </li>
                    <li class="time-label">
                        <span class="bg-red">第二步</span>
                    </li>
                    <li>
                        <i class="fa fa-user bg-aqua"></i>
                        <div class="timeline-item">
                            <h3 class="timeline-header no-border">
                                <a href="#">创建产品</a></h3>
                            <div class="timeline-body">
                                <h4>用户打开连接
                                    首次注册登入的用户会看到以下页面
                                </h4>
                                <img src="__STATIC__/customer/img/create_product.jpg" class="margin" height="400" width="700"/>
                                <h4>点击添加产品按钮后来到以下界面,输入产品信息后点击保存</h4>
                                <img src="__STATIC__/customer/img/product_add.jpg" class="margin" height="400" width="700"/>
                                <h4>点击保存以后,系统会自动跳转到产品列表页,点击你刚刚创建的产品</h4>
                                <img src="__STATIC__/customer/img/product_list.jpg" class="margin" height="400" width="700"/>
                            </div>
                        </div>
                    </li>
                    <li class="time-label">
                        <span class="bg-red">第三步</span>
                    </li>
                    <li>
                        <i class="fa fa-user bg-aqua"></i>
                        <div class="timeline-item">
                            <h3 class="timeline-header no-border">
                                <a href="#">添加数据流模板</a></h3>
                            <div class="timeline-body">
                                <h4>点击数据管理,接着点击数据流模板列表,如图所示</h4>
                                <img src="__STATIC__/customer/img/template_list.jpg" class="margin" height="400" width="700"/>
                                <h4>点击页面右上角的添加数据流模板,出现以下界面,输入数据流模板信息后点击保存</h4>
                                <img src="__STATIC__/customer/img/template_add.jpg" class="margin" height="400" width="700"/>
                            </div>
                        </div>
                    </li>
                    <li class="time-label">
                        <span class="bg-red">第四步</span>
                    </li>
                    <li>
                        <i class="fa fa-user bg-aqua"></i>
                        <div class="timeline-item">
                            <h3 class="timeline-header no-border">
                                <a href="#">添加设备</a></h3>
                            <div class="timeline-body">
                                <h4>点击设备管理,接着点击设备列表,如图所示</h4>
                                <img src="__STATIC__/customer/img/device_list.jpg" class="margin" height="400" width="700"/>
                                <h4>点击页面右上角的添加设备按钮,出现以下界面,输入设备信息后点击保存</h4>
                                <img src="__STATIC__/customer/img/device_add.jpg" class="margin" height="400" width="700"/>
                            </div>
                        </div>
                    </li>
                    <li class="time-label">
                        <span class="bg-red">第五步</span>
                    </li>
                    <li>
                        <i class="fa fa-user bg-aqua"></i>
                        <div class="timeline-item">
                            <h3 class="timeline-header no-border">
                                <a href="#">设备接入指南--鉴权</a></h3>
                            <div class="timeline-body">
                                <h4>
                                    接入JasonNet的设备必须能正常接入互联网且必须使用MQTT协议并按一定的格式向平台发起接入请求,详细步骤如下:
                                </h4>
                                <br>
                                <p>a.首先用户需要拿到要接入设备的ID和鉴权信息</p>
                                <img src="__STATIC__/customer/img/device_info.jpg" class="margin" height="400" width="700"/>
                                <br>
                                <p>b.待接入的设备向服务器发送鉴权信息,具体接口调用如下表所示</p>
                                <table class="table table-bordered table-hover">
                                    <tr>
                                        <td>接入地址</td>
                                        <td>http://120.78.78.42</td>
                                    </tr>

                                    <tr>
                                        <td>Port</td>
                                        <td>1883</td>
                                    </tr>
                                    <tr>
                                        <td>Topic</td>
                                        <td>auth</td>
                                    </tr>
                                    <tr>
                                        <td>Payload</td>
                                        <td>

                                            <pre>
  // 设备接入示例
  {
    // api_key(必填)
    "api_key": "MTUyNTU3NDI3MzY2MTUw",
    // 产品id(必填)
    "product_id": 1,
    // 设备id(必填)
    "device_id": "20181516",
    // 鉴权信息(必填)
    "device_auth": "device_mi7",
    // 接收鉴权的主题(必填)
    "response_topic":"response_topic"

  },
                                            </pre>
                                        </td>
                                    </tr>
                                </table>
                                <p>c.设备发送鉴权信息后,需订阅自己预设的接收反馈信息的主题.服务器返回信息如下</p>
                                <table class="table table-bordered table-hover">

                                    <tr>
                                        <td>Topic</td>
                                        <td>自定义(如:response_topic)</td>
                                    </tr>
                                    <tr>
                                        <td>Payload</td>
                                        <td>
                                            <pre>
// 服务器返回信息
  {
    // 设备id
    "device_id": 20181516,
    // 鉴权结果,成功返回'pass',失败返回'failure'
    "result": "pass"
  },
                                            </pre>
                                        </td>
                                    </tr>
                                </table>
                                <small>Tip:如果设备鉴权结果返回'pass'就可以进行数据上报的操作,否则请检查所填写信息是否正确,直到鉴权通过为止</small>
                            </div>
                        </div>
                    </li>
                    <!-- END timeline item -->
                    <!-- timeline item -->
                    <li>
                        <i class="fa fa-comments bg-yellow"></i>

                        <div class="timeline-item">

                            <h3 class="timeline-header"><a href="#">设备接入指南--数据上报</a> </h3>

                            <div class="timeline-body">
                                <h4>设备数据上报流程如下(设备需要向指定的主题发布消息):</h4>
                                <table class="table table-bordered table-hover">
                                    <tr>
                                        <td>接入地址</td>
                                        <td>http://120.78.78.42</td>
                                    </tr>
                                    <tr>
                                        <td>Port</td>
                                        <td>1883</td>
                                    </tr>
                                    <tr>
                                        <td>Topic</td>
                                        <td>data</td>
                                    </tr>
                                    <tr>
                                        <td>Payload</td>
                                        <td>
                                            <pre>
  // 数据上报
  {
    // 设备ID(必填)
    "device_id":"20181516",
    // 数据类型(必填)
    "data_type":"data",
    // 数据内容(必填)
    "data_content": 68,
    // 创建时间(必填)
    "create_time":"1524905493",
    // 更新时间(必填)
    "update_time":"1524905493"
  },
                                            </pre>
                                        </td>
                                    </tr>
                                </table>
                                <p><strong>Tips:鉴权通过的设备会被加入白名单,需要注意的是白名单有限期为600秒,若是设备在600秒内没有发送任何数据,
                                    将会被踢出白名单.再次上报数据时需要再次进行鉴权.若是设备在600秒上</strong></p>
                                <p style="text-indent: 2.3em"><strong >报了数据,系统将重置当前设备的白名单时间为600秒,无需鉴权!</strong>
                                </p>
                                <p><strong>Tips:为节省系统和节点的资源,服务器接收数据后将不会进行响应</strong></p>
                            </div>

                        </div>
                    </li>
                </ul>
            </div>
            <!-- /.col -->
        </div>
        <!-- /.row -->



    </section>
</div>
{{/block}}

{{block name="js"}}
<script>
    $(function () {
        info('{{$flag ?? 1}}');
    });
</script>

{{/block}}

